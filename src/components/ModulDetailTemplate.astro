---
import Layout from "../layouts/Layout.astro";
import TiltCard from "./TiltCard.astro";

const { nav } = Astro.props;

const modulesData = Array.from({ length: 14 }, (_, i) => {
  const num = i + 1;
  const colors = [
    "bg-purple-600",
    "bg-blue-500",
    "bg-emerald-500",
    "bg-orange-500",
    "bg-pink-600",
    "bg-gray-800",
    "bg-sky-500",
    "bg-indigo-600",
    "bg-emerald-600",
    "bg-red-500",
    "bg-orange-600",
    "bg-cyan-600",
    "bg-blue-700",
    "bg-yellow-500",
  ];
  const emojis = [
    "â„¹ï¸",
    "ğŸ”¢",
    "ğŸ“¡",
    "ğŸ§ ",
    "ğŸ”Œ",
    "ğŸŒ",
    "â˜ï¸",
    "ğŸ“",
    "ğŸ–¥ï¸",
    "ğŸ’¾",
    "ğŸ’¿",
    "ğŸ’»",
    "ğŸ“Š",
    "ğŸ›¡ï¸",
  ];

  return {
    title: nav[`m${num}T`],
    desc: nav[`m${num}D`],
    color: colors[i],
    emoji: emojis[i],
    label: nav.label,
  };
});
---

<Layout title={`${nav.label2} 1 Detail`} lang={nav.lang}>
  <section class="py-20 bg-white min-h-screen">
    <div class="max-w-7xl mx-auto px-4">
      <a
        href={`${import.meta.env.BASE_URL}${nav.lang}/#portfolio`}
        class="mb-10 inline-block font-black text-purple-600 italic hover:underline decoration-4"
      >
        â† {nav.btnBack || "ZurÃ¼ck"}
      </a>

      <h1
        class="text-4xl md:text-5xl font-black italic text-gray-900 mb-16 tracking-tighter leading-none"
      >
        {nav.label2} 1: <span class="text-blue-700"
          >{nav.careerM1 || nav.c1}</span
        >
      </h1>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-10">
        {
          modulesData.map((mod, i) => (
            <div class="h-[380px]">
              <TiltCard
                modNumber={(i + 1).toString()}
                title={mod.title}
                desc={mod.desc}
                colorClass={mod.color}
                emoji={mod.emoji}
                label={mod.label}
              />
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <div
    id="module-modal"
    class="fixed inset-0 z-[100] hidden items-center justify-center p-4 bg-black/80 backdrop-blur-sm opacity-0 transition-opacity duration-300"
  >
    <div
      class="modal-content bg-white border-4 border-black rounded-[2.5rem] shadow-[12px_12px_0px_#000] max-w-2xl w-full p-10 relative scale-90 transition-transform duration-300"
    >
      <button
        id="close-modal"
        class="absolute top-6 right-6 w-10 h-10 flex items-center justify-center bg-gray-100 rounded-full hover:bg-black hover:text-white transition-all font-black"
        >âœ•</button
      >

      <div
        id="modal-label"
        class="bg-purple-600 text-white px-4 py-1 rounded-full text-xs font-black mb-4 inline-block border-2 border-black"
      >
      </div>

      <h2
        id="modal-title"
        class="text-4xl font-black italic uppercase leading-none mb-8 text-gray-900 tracking-tighter"
      >
      </h2>

      <div
        id="modal-desc"
        class="space-y-4 text-lg font-medium text-gray-700 max-h-[50vh] overflow-y-auto pr-4 scrollbar-thin scrollbar-thumb-black"
      >
      </div>
    </div>
  </div>

  <script>
    const modal = document.getElementById("module-modal");
    const modalContent = modal?.querySelector(".modal-content");
    const closeBtn = document.getElementById("close-modal");
    const triggers = document.querySelectorAll(".module-card-trigger");

    function openModal(data: any) {
      if (!modal || !modalContent) return;

      document.getElementById("modal-title")!.innerText = data.title;
      document.getElementById("modal-label")!.innerText =
        `${data.label} ${data.num}`;

      const descContainer = document.getElementById("modal-desc")!;
      descContainer.innerHTML = "";

      const descData = JSON.parse(data.desc);

      if (Array.isArray(descData)) {
        const ul = document.createElement("ul");
        ul.className = "space-y-3";
        descData.forEach((item) => {
          const li = document.createElement("li");
          li.className =
            "text-gray-800 font-medium leading-relaxed tracking-wide antialiased";
          li.innerHTML = `<span class="text-purple-600 font-bold">â€¢</span> <span>${item}</span>`;
          ul.appendChild(li);
        });
        descContainer.appendChild(ul);
      } else {
        descContainer.innerHTML = `<p>${descData}</p>`;
      }

      modal.classList.remove("hidden");
      modal.classList.add("flex");
      setTimeout(() => {
        modal.classList.add("opacity-100");
        modalContent.classList.add("scale-100");
      }, 10);
      document.body.style.overflow = "hidden";
    }

    function closeModal() {
      modal?.classList.remove("opacity-100");
      modalContent?.classList.remove("scale-100");
      setTimeout(() => {
        modal?.classList.add("hidden");
        modal?.classList.remove("flex");
        document.body.style.overflow = "";
      }, 300);
    }

    triggers.forEach((t) =>
      t.addEventListener("click", () => openModal((t as HTMLElement).dataset)),
    );
    closeBtn?.addEventListener("click", closeModal);
    modal?.addEventListener("click", (e) => e.target === modal && closeModal());
  </script>
</Layout>
